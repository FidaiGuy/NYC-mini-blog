geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = "lightblue")
NYPD_shooting_data %>%
mutate(OCCUR_HOUR = hour(OCCUR_TIME),) %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021) %>%
group_by(BORO, OCCUR_HOUR) %>%
summarize(n = n()) %>%
ggplot(aes(x = OCCUR_HOUR, y = BORO, fill = n))+
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = "lightblue")
NYPD_shooting_data %>%
mutate(OCCUR_HOUR = hour(OCCUR_TIME),) %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021) %>%
group_by(BORO, OCCUR_HOUR) %>%
summarize(n = n()) %>%
ggplot(aes(x = OCCUR_HOUR, y = BORO, fill = n))+
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = NA)
NYPD_shooting_data %>%
mutate(OCCUR_HOUR = hour(OCCUR_TIME),) %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021 & STATISTICAL_MURDER_FLAG == TRUE) %>%
group_by(BORO, OCCUR_HOUR) %>%
summarize(n = n()) %>%
ggplot(aes(x = OCCUR_HOUR, y = BORO, fill = n))+
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = NA)
NYPD_shooting_data %>%
mutate(OCCUR_HOUR = hour(OCCUR_TIME),) %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021) %>%
group_by(BORO, OCCUR_HOUR) %>%
summarize(n = n()) %>%
ggplot(aes(x = OCCUR_HOUR, y = BORO, fill = n))+
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = NA)
NYPD_shooting_data %>%
mutate(OCCUR_HOUR = hour(OCCUR_TIME),) %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021) %>%
group_by(BORO, OCCUR_HOUR) %>%
summarize(n = n()) %>%
ggplot(aes(x = OCCUR_HOUR, y = BORO, fill = n))+
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = NA)
NYPD_shooting_data %>%
mutate(OCCUR_HOUR = hour(OCCUR_TIME),) %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021) %>%
group_by(BORO, OCCUR_HOUR) %>%
summarize(n = n()) %>%
ggplot(aes(x = OCCUR_HOUR, y = BORO, fill = n))+
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = NA)
NYPD_shooting_data %>%
mutate(OCCUR_HOUR = hour(OCCUR_TIME),) %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021) %>%
group_by(BORO, OCCUR_HOUR) %>%
summarize(n = n()) %>%
ggplot(aes(x = OCCUR_HOUR, y = BORO, fill = n))+
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = NA)
NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021) %>%
leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data$Longitude,
~NYPD_shooting_data$Latitude,
clusterOptions = markerClusterOptions()) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions()) %>%
setView(-74.00, 40.71, zoom = 11)
leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions()) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions()) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions()) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions())
View(NYPD_shooting_data_2021)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions()) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue")) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue")) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue")) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue")) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue")) %>%
setView(-74.00, 40.71, zoom = 11) %>%
popupTable(NYPD_shooting_data_2021)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11) %>%
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11) %>%
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = ~NYPD_shooting_data_2021$OCCUR_DATE %>%
setView(-74.00, 40.71, zoom = 11) %>%
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = ~NYPD_shooting_data_2021$OCCUR_DATE) %>%
setView(-74.00, 40.71, zoom = 11) %>%
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = ~NYPD_shooting_data_2021$OCCUR_DATE) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
install.packages("mapview")
install.packages("mapview")
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = mapview::popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
install.packages("satellite")
install.packages("satellite")
install.packages("satellite")
install.packages("mapview")
install.packages("satellite")
install.packages("C:/Users/samirfidai/Downloads/satellite_1.0.5.tar.gz", repos = NULL, type = "source")
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = mapview::popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
install.packages("classInt")
install.packages("classInt")
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = mapview::popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
install.packages("units")
install.packages("units")
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = mapview::popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
library(tidyverse)
library(plotly)
library(leaflet)
library(ggpubr)
library(mapview)
theme_set(theme_minimal())
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
library(tidyverse)
library(plotly)
library(leaflet)
library(ggpubr)
library(mapview)
theme_set(theme_minimal())
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = popupTable(NYPD_shooting_data_2021)) %>%
setView(-74.00, 40.71, zoom = 11)
library(tidyverse)
library(plotly)
library(leaflet)
library(ggpubr)
library(mapview)
theme_set(theme_minimal())
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue")) %>%
setView(-74.00, 40.71, zoom = 11)
library(tidyverse)
library(plotly)
library(leaflet)
library(ggpubr)
library(mapview)
theme_set(theme_minimal())
NYPD_shooting_data <- read_csv(here::here("NYPD_Shooting_Incident_Data__Historic__20240422.csv"))
NYPD_shooting_data %>% glimpse()
NYPD_shooting_data <- NYPD_shooting_data %>%
mutate(
OCCUR_DATE = mdy(OCCUR_DATE),
OCCUR_YEAR = year(OCCUR_DATE)
)
murders_by_borough <- NYPD_shooting_data %>%
filter(STATISTICAL_MURDER_FLAG == TRUE) %>%
mutate(occur_year = year(OCCUR_DATE)) %>%
group_by(BORO, occur_year) %>%
summarize(murders = n()) %>%
ggplot(aes(occur_year, murders)) +
geom_line(aes(color = BORO)) +
scale_x_continuous(breaks = seq(2006, 2024, 1)) +
ggtitle('Shootings classified as Murders by Borough')+
theme(legend.position = "top")
murders_by_race <- NYPD_shooting_data %>%
filter(STATISTICAL_MURDER_FLAG == TRUE) %>%
mutate(occur_year = year(OCCUR_DATE)) %>%
group_by(VIC_RACE, occur_year) %>%
summarize(murders = n()) %>%
ggplot(aes(occur_year, murders)) +
geom_line(aes(color = VIC_RACE)) +
scale_x_continuous(breaks = seq(2006, 2024, 1)) +
ggtitle('Shootings classified as Murders by Race') +
theme(legend.position = "top")
ggpubr::ggarrange(murders_by_borough, murders_by_race, ncol = 1, widths = c(9,1))
ggplotly(
NYPD_shooting_data %>%
mutate(OCCUR_HOUR = hour(OCCUR_TIME),) %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021) %>%
group_by(BORO, OCCUR_HOUR) %>%
summarize(n = n()) %>%
ggplot(aes(x = OCCUR_HOUR, y = BORO, fill = n))+
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = NA) +
labs(title = "Time of Shooting Incident in NYC in 2020 by Borough"))
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
popup_view = paste0(
"<b> Incident Date: </b>",
NYPD_shooting_data_2021$OCCUR_DATE,
"<br>",
"<b>Victim's Age: </b>",
NYPD_shooting_data_2021$VIC_AGE_GROUP,
"<br>",
"<b>Victim's Sex: </b>",
NYPD_shooting_data_2021$VIC_SEX,
"<br>",
"<b>Victim's Race: </b>",
NYPD_shooting_data_2021$VIC_RACE
)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTitle
library(tidyverse)
library(plotly)
library(leaflet)
library(ggpubr)
library(mapview)
theme_set(theme_minimal())
NYPD_shooting_data <- read_csv(here::here("NYPD_Shooting_Incident_Data__Historic__20240422.csv"))
NYPD_shooting_data %>% glimpse()
NYPD_shooting_data <- NYPD_shooting_data %>%
mutate(
OCCUR_DATE = mdy(OCCUR_DATE),
OCCUR_YEAR = year(OCCUR_DATE)
)
murders_by_borough <- NYPD_shooting_data %>%
filter(STATISTICAL_MURDER_FLAG == TRUE) %>%
mutate(occur_year = year(OCCUR_DATE)) %>%
group_by(BORO, occur_year) %>%
summarize(murders = n()) %>%
ggplot(aes(occur_year, murders)) +
geom_line(aes(color = BORO)) +
scale_x_continuous(breaks = seq(2006, 2024, 1)) +
ggtitle('Shootings classified as Murders by Borough')+
theme(legend.position = "top")
murders_by_race <- NYPD_shooting_data %>%
filter(STATISTICAL_MURDER_FLAG == TRUE) %>%
mutate(occur_year = year(OCCUR_DATE)) %>%
group_by(VIC_RACE, occur_year) %>%
summarize(murders = n()) %>%
ggplot(aes(occur_year, murders)) +
geom_line(aes(color = VIC_RACE)) +
scale_x_continuous(breaks = seq(2006, 2024, 1)) +
ggtitle('Shootings classified as Murders by Race') +
theme(legend.position = "top")
ggpubr::ggarrange(murders_by_borough, murders_by_race, ncol = 1, widths = c(9,1))
ggplotly(
NYPD_shooting_data %>%
mutate(OCCUR_HOUR = hour(OCCUR_TIME),) %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021) %>%
group_by(BORO, OCCUR_HOUR) %>%
summarize(n = n()) %>%
ggplot(aes(x = OCCUR_HOUR, y = BORO, fill = n))+
geom_tile() +
scale_fill_gradient(low = "lightblue", high = "darkblue", na.value = NA) +
labs(title = "Time of Shooting Incident in NYC in 2020 by Borough"))
NYPD_shooting_data_2021 <- NYPD_shooting_data %>%
dplyr::filter(OCCUR_YEAR >= 2020 & OCCUR_YEAR < 2021)
popup_view = paste0(
"<b> Incident Date: </b>",
NYPD_shooting_data_2021$OCCUR_DATE,
"<br>",
"<b>Victim's Age: </b>",
NYPD_shooting_data_2021$VIC_AGE_GROUP,
"<br>",
"<b>Victim's Sex: </b>",
NYPD_shooting_data_2021$VIC_SEX,
"<br>",
"<b>Victim's Race: </b>",
NYPD_shooting_data_2021$VIC_RACE
)
NYPD_shooting_data_2021 %>% leaflet() %>%
addTiles() %>%
addCircleMarkers(~NYPD_shooting_data_2021$Longitude,
~NYPD_shooting_data_2021$Latitude,
clusterOptions = markerClusterOptions(),
color = ~ifelse(STATISTICAL_MURDER_FLAG == TRUE, "red", "blue"),
popup = ~popup_view) %>%
setView(-74.00, 40.71, zoom = 11) %>%
addLegend("bottomleft",
colors = c("red", "blue"),
labels = c("Yes", "No"),
title = "Shooting resulted in the victim's death")
